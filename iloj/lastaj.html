<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="manifest" href="vortaro.webmanifest">
    <meta name="description" content="à¸à¸ˆà¸™à¸²à¸™à¸¸à¸à¸£à¸¡à¹€à¸­à¸ªà¹€à¸›à¸£à¸±à¸™à¹‚à¸•-à¹„à¸—à¸¢ Esperanto - Taja Interreta Vortaro">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../ikono/android/android-launchericon-48-48.png">
    <title>à¸à¸ˆà¸™à¸²à¸™à¸¸à¸à¸£à¸¡à¹€à¸­à¸ªà¹€à¸›à¸£à¸±à¸™à¹‚à¸•-à¹„à¸—à¸¢</title>
    <link rel="stylesheet" href="../stilo.css">
  </head>
  <body>
    <script  src="../lasta_sxangxo.js"></script>
    <a href="pri.html"><pre id="statistiko"></pre></a>
    <h3>à¸à¸ˆà¸™à¸²à¸™à¸¸à¸à¸£à¸¡à¹€à¸­à¸ªà¹€à¸›à¸£à¸±à¸™à¹‚à¸•-à¹„à¸—à¸¢</h3>
    <a href="../pri.html">ğŸ  à¸«à¸™à¹‰à¸²à¸«à¸¥à¸±à¸</a>
    <h3>à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡à¸¥à¹ˆà¸²à¸ªà¸¸à¸”</h3>
    <!-- <button onclick="redaktejoTipo(0)">à¸„à¸³à¹à¸à¹‰à¹„à¸‚</button>
    <button onclick="redaktejoTipo(1)">à¸„à¸³à¹€à¸à¸´à¹ˆà¸¡à¹ƒà¸«à¸¡à¹ˆ</button> -->
    <span id="statistiko"></span>
    <span id="tuto" style="display: none;"></span>
    <span>âš’ï¸à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹à¸à¹‰à¹„à¸‚ <span id="st_lastaj"></span> à¸„à¸³</span>
    ğŸŒ¥ï¸à¸¥à¹ˆà¸²à¸ªà¸¸à¸”à¹€à¸¡à¸·à¹ˆà¸­ <span id="lasta_dato"></span>
    <script  src="../eoth-vortaro.js"></script>
    <script  src="../skriptoj/lasta_sxangxo.js"></script>
    <br>
    <br>
    <details>
      <summary>ğŸ“†à¸ªà¸–à¸´à¸•à¸•à¸²à¸¡à¸§à¸±à¸™</summary>
        <div id="statistiko_dato"></div>
    </details>
    <a href="https://github.com/warut92/vortaro/commit/master" target="_blank"><p>ğŸ”à¸”à¸¹à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¹à¸›à¸¥à¸‡à¸—à¸µà¹ˆ Github</p></a>

    
    <div id="lastaj"></div>
  </body>
  <script  src="../eoth-vortaro.js"></script>
  <scrip>
    <script>
    //preni variablon de th-vortaro.js kaj konverti al Array (tabeltipo) pere de <br>
    vortaro = vortaro.replace(/\/\/\((.*?)\)\/\//g, '<i>($1)</i>')

    //la etikedo por bildoj
    vortaro = vortaro.replace(/IMG:\[(.*?)\]/g, '<img src="$1">')
    //solvi cimon Ä‰e IMG
    .replace(/https:<i>upload/gm, 'https://upload')
    .replace(/https:<\/i>upload/gm, 'https://upload')

    //konverti la fakideksojn kun speciala etikedo
    vortaro = vortaro.replace(/(\{.{3,4}\})/g, '<fak>$1</fak>')
    vortaro = vortaro.replace(/\n/gm, '<br>')
    // vortaro = vortaro.replace(/^(.*)(@[\d]{8}\/[\d]{6})$/, '$2')
    vortaro = vortaro.split(/<br>/g)

    //serÄ‰i nur array kiuj enhavas "[\d]"
    let sxablono_regex = /@/;
    let rezulto = vortaro.filter(function(str) {
    	return sxablono_regex.test(str);
    });
    //konverti Äin al string kaj aldoni Ä‰e la fino <br>
    rezulto = rezulto.toString()
    rezulto = rezulto.replace(/,(?!\s)/g, "\n");
    
    //reformatigi la datformon.
    //-w estis la rimarkilo por vortoj redaktitaj antaÅ­ la reteja renovigo
    rezulto = rezulto.replace(/-w/g, " 00:00:00")
    .replace(/(\d{2})-(\d{2})-(\d{4}) (\d{2}):(\d{2}):(\d{2})/g, "$3$2$1/$4$5$6")
    // console.log(rezulto);
    //forigi la lastan @
    rezulto = rezulto.replace(/@$/gm, '')
    //forigi Ä‰ion en la formato @(.*?)@, tio estis la datoj de antaÅ­aj redakt-datoj
    rezulto = rezulto.replace(/ @(.*?)@ /gm, ' ').replace(/ @(.*?)@ /gm, ' ')
    // console.log('REZULTO', rezulto)

    //ARRAY
    //forigi \n kaj konverti al Array
    rezulto = rezulto.split(/\n/gm)

    //aranÄi pere de dato
    rezulto.sort((a, b) => {
      //forigi ciferojn ene de la krampoj de vortlisto
      const forgiA = a.replace(/\[\d+\]/g, '').replace(/\//g, '');
      const forgiB = b.replace(/\[\d+\]/g, '').replace(/\//g, '');

      //kapti nur liniojn, kiu enhavas helikon.
      const indicoA = forgiA.indexOf('@');
      const indicoB = forgiB.indexOf('@');
      //kompari
      if (indicoA !== -1 && indicoB !== -1) {
        const ciferoA = forgiA.substring(indicoA + 1).match(/\d+/);
        const ciferoB = forgiB.substring(indicoB + 1).match(/\d+/);

        if (ciferoA && ciferoB) {
          return parseInt(ciferoB[0]) - parseInt(ciferoA[0]);
        }
      }

      return 0;
    });

    //aranÄi laÅ­ esperanta ordo.
    let re_aranÄita_rezulto = rezulto
    //montras kvanton de la redaktitaj vortoj
    let kvanto_de_redaktoj = re_aranÄita_rezulto.length
    document.getElementById('st_lastaj').innerHTML = kvanto_de_redaktoj.toLocaleString("en-US");
    //aldoni <br> per anstaÅ­igi la lastajn komojn
    re_aranÄita_rezulto = re_aranÄita_rezulto.toString().replace(/,(?!\s)/g, "<br><hr>")

    //MONTRU LA REDAKTITAJN LINIOJN ALÅ¬ LA TAGO
    //STRING
    document.getElementById("lastaj").innerHTML = re_aranÄita_rezulto;
    console.log(re_aranÄita_rezulto);
    //STATISTIKO LAÅ¬ LA DATOJ
    //forigi Ä‰ion krom la datoj kaj aranÄi ilin al linioj.
    //disigi Äin al alenioj
    let statistiko_dato_str = re_aranÄita_rezulto.replace(/<br><hr>/g,"\n")
    
    console.log(statistiko_dato_str);
    //forigi Ä‰iajn antaÅ­aÄµojn de @
    statistiko_dato_str = statistiko_dato_str.replace(/.*(?=@\d)/g,"")
    statistiko_dato_str = statistiko_dato_str.replace(/\/.*/g,"")
    //ÅanÄi @ al emoÄµio horloÄo
    statistiko_dato_str = statistiko_dato_str.replace(/@/g,"ğŸ•§")

    const statistiko_dato_ARR = statistiko_dato_str.split("\n")

    const fojo = {};

    statistiko_dato_ARR.forEach(date => {
      fojo[date] = (fojo[date] || 0) + 1;
    });

    let statistiko = ""
    for (const date in fojo) {
      statistiko += `${date} = ${fojo[date]} à¸„à¸³à¸«à¸¥à¸±à¸<br>`;
    }
    // console.log(statistiko);
    document.getElementById('statistiko_dato').innerHTML = statistiko
  </script>
</html>
